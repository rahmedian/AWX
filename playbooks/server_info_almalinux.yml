cat > playbooks/quick_report_almalinux.yml << 'EOF'
---
- name: Reporte Rápido - AlmaLinux 9
  hosts: all
  gather_facts: yes
  become: yes
  
  tasks:
    - name: Recopilar información esencial
      shell: |
        echo "OS=$(cat /etc/os-release | grep PRETTY_NAME | cut -d'"' -f2)"
        echo "KERNEL=$(uname -r)"
        echo "HOSTNAME=$(hostnamectl --static)"
        echo "IP=$(ip -4 addr show {{ ansible_default_ipv4.interface }} | grep inet | awk '{print $2}' | cut -d/ -f1)"
        echo "GATEWAY=$(ip route | grep default | awk '{print $3}')"
        
        if rpm -q httpd &>/dev/null; then
          echo "APACHE=Instalado ($(rpm -q httpd --queryformat '%{VERSION}'))"
          echo "APACHE_STATUS=$(systemctl is-active httpd)"
        else
          echo "APACHE=No instalado"
          echo "APACHE_STATUS=N/A"
        fi
        
        if rpm -q nginx &>/dev/null; then
          echo "NGINX=Instalado ($(rpm -q nginx --queryformat '%{VERSION}'))"
          echo "NGINX_STATUS=$(systemctl is-active nginx)"
        else
          echo "NGINX=No instalado"
          echo "NGINX_STATUS=N/A"
        fi
        
        echo "UPTIME=$(uptime -p)"
        echo "LOAD=$(uptime | awk -F'load average:' '{print $2}' | xargs)"
      register: quick_info
      changed_when: false
    
    - name: Mostrar reporte rápido
      debug:
        msg: |
          
          ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
          ┃        REPORTE RÁPIDO DEL SERVIDOR           ┃
          ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
          
          {{ quick_info.stdout }}
          
          ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
EOF
